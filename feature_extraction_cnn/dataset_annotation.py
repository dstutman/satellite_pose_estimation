### Building a dataset for Delfi-n3xt satellite ###
import json, os, numpy as npface

###### KEYPOINT AND BOUNDING BOX LABELS FOR TRAINING ######
# Counting begins from the corner that is on the lower edge
# of the satellite, on the -Z face of the satellite (opposite
# the yellow antennae)
# Then, count upwards clockwise. Repeat the same for the top face
# to cover all 8 corners of the satellite (go around in the same
# direction as you did on the bottom face, though.)
img_2936 = {'name': 'IMG_2936', 'bboxes': [[1230, 1180, 1796, 1810], [2142, 1424, 2430, 1982]],
            'keypoints': [[[1441, 1792, 1], [1300, 1463, 1], [1584, 1203, 1],
            [1748, 1522, 1]], [[2174, 1962, 1], [0, 0, 0],
            [0, 0, 0], [2413, 1780, 1]]]}

img_2937 = {'name': 'IMG_2937', 'bboxes': [[1088, 784, 1362, 1304], [2130, 1122, 2414, 1732]],
            'keypoints': [[[0, 0, 0], [0, 0, 0], [1330, 830, 1],
            [1113, 1076, 1]], [[2207, 1718, 1], [0, 0, 0],
            [2347, 1198, 1], [2134, 2509, 1]]]}

img_2938 = {'name': 'IMG_2938', 'bboxes': [[874, 634, 1254, 1082], [1576, 904, 2034, 1534]],
            'keypoints': [[[0, 0, 0], [0, 0, 0], [1102, 644, 1],
            [882, 878, 1]], [[1786, 1506, 1], [2016, 1228, 1], 
            [1866, 933, 1], [1608, 1304, 1]]]}

img_2939 = {'name': 'IMG_2939', 'bboxes': [[1116, 570, 1594, 854], [1334, 902, 1934, 1462]],
            'keypoints': [[[0, 0, 0], [0, 0, 0], [1359, 576, 1],
            [1151, 801, 1]], [[1652, 1448, 1], [1916, 1173, 1],
            [1646, 922, 1], [1360, 1225, 1]]]}

img_2940 = {'name': 'IMG_2940', 'bboxes': [[1912, 766, 2308, 1004], [1634, 998, 2190, 1608]],
            'keypoints': [[[0, 0, 0], [2299, 960, 1], [2087, 775, 1],
            [0, 0, 0]], [[1922, 1590, 1], [2151, 1354, 1],
            [1857, 1112, 1], [1641, 1366, 1]]]}

img_2941 = {'name': 'IMG_2941', 'bboxes': [[2462, 658, 2834, 1082], [1750, 968, 2114, 1470]],
            'keypoints': [[[0, 0, 0], [2823, 850, 1], [2610, 650, 1],
            [0, 0, 0]], [[1976, 1460, 1], [2089, 1244, 1],
            [1851, 986, 1], [1761, 1218, 1]]]}

img_2942 = {'name': 'IMG_2942', 'bboxes': [[2864, 1368, 3022, 1896], [1704, 1590, 1906, 2066]],
            'keypoints': [[[2996, 1878, 1], [3008, 1724, 1], [2925, 1403, 1],
            [0, 0, 0]], [[1838, 2050, 1], [1738, 1922, 1],
            [1735, 1614, 1], [0, 0, 0]]]}

img_5806 = {'name': 'IMG_5806', 'bboxes': [[2700, 792, 3180, 1590], [1610, 1174, 2072, 1734]],
            'keypoints': [[[3014, 1577, 1], [2717, 1197, 1], [2905, 831, 1],
            [3166, 1204, 1]], [[1889, 1725, 1], [1637, 1473, 1],
            [1828, 1201, 1], [0, 0, 0]]]}

img_5807 = {'name': 'IMG_5807', 'bboxes': [[1702, 954, 2570, 1766], [1764, 1604, 2348, 1866]],
            'keypoints': [[[2150, 1758, 1], [1745, 1346, 1], [2153, 961, 1],
            [2555, 1363, 1]], [[0, 0, 0], [0, 0, 0],
            [0, 0, 0], [0, 0, 0]]]}

img_5808 = {'name': 'IMG_5808', 'bboxes': [[1030, 1008, 1478, 1822], [2370, 1324, 2726, 1992]],
            'keypoints': [[[1146, 1808, 1], [1052, 1380, 1], [1322, 1020, 1],
            [1452, 1440, 1]], [[2424, 1980, 1], [0, 0, 0],
            [2532, 1410, 1], [2715, 1735, 1]]]}

img_5810 = {'name': 'IMG_5810', 'bboxes': [[974, 890, 1246, 1408], [2202, 1094, 2384, 1692]],
            'keypoints': [[[1062, 1396, 1], [0, 0, 0], [1201, 923, 1],
            [997, 1082, 1]], [[2235, 1665, 1], [0, 0, 0],
            [2367, 1131, 1], [2253, 1334, 1]]]}

img_5811 = {'name': 'IMG_5811', 'bboxes': [[1138, 1184, 1454, 1652], [1956, 1232, 2356, 1820]],
            'keypoints': [[[1326, 1663, 1], [0, 0, 0], [1400, 1224, 1],
            [1171, 1405, 1]], [[2128, 1808, 1], [2344, 1562, 1],
            [2210, 1246, 1], [1972, 1482, 1]]]}

img_5813 = {'name': 'IMG_5813', 'bboxes': [[2356, 1040, 2668, 1458], [1556, 1146, 1956, 1670]],
            'keypoints': [[[2542, 1448, 1], [2656, 1198, 1], [0, 0, 0],
            [0, 0, 0]], [[1818, 1656, 1], [1918, 1345, 1],
            [1682, 1152, 1], [1593, 1462, 1]]]}

img_5814 = {'name': 'IMG_5814', 'bboxes': [[2658, 966, 2890, 1420], [1608, 1180, 1822, 1702]],
            'keypoints': [[[2833, 1400, 1], [2869, 1109, 1], [0, 0, 0],
            [0, 0, 0]], [[1779, 1680, 1], [1754, 1375, 1],
            [1641, 1207, 1], [0, 0, 0]]]}

img_3025 = {'name': 'IMG-3025', 'bboxes': [[998, 1250, 1214, 1934], [2454, 1548, 2694, 2220]],
            'keypoints': [[[1012, 1913, 1], [0, 0, 0], [0, 0, 0],
            [1023, 1665, 1]], [[2491, 2181, 1], [0, 0, 0],
            [2634, 1603, 1], [2673, 1981, 1]]]}

img_3026 = {'name': 'IMG-3026', 'bboxes': [[0, 944, 198, 2180], [3792, 1088, 4024, 2272]],
            'keypoints': [[[0, 0, 0], [0, 0, 0], [0, 0, 0],
            [0, 0, 0]], [[0, 0, 0], [0, 0, 0],
            [3968, 1122, 1], [0, 0, 0]]]}

img_3027 = {'name': 'IMG-3027', 'bboxes': [[80, 808, 324, 2002], [3654, 1062, 3886, 2164]],
            'keypoints': [[[122, 1986, 1], [0, 0, 0], [0, 0, 0],
            [0, 0, 0]], [[3782, 2146, 1], [0, 0, 0],
            [0, 0, 0], [3854, 1136, 1]]]}

img_3028 = {'name': 'IMG-3028', 'bboxes': [[2, 2, 3, 3], [236, 454, 2558, 2788]],
            'keypoints': [[[0, 0, 0], [0, 0, 0], [0, 0, 0],
            [0, 0, 0]], [[2064, 2758, 1], [2534, 1118, 1],
            [856, 522, 1], [268, 2334, 1]]]}

img_3029 = {'name': 'IMG-3029', 'bboxes': [[952, 214, 3804, 3016], [2, 2, 3, 3]],
            'keypoints': [[[2010, 3014, 1], [1078, 1160, 1], [2874, 288, 1],
            [3790, 2042, 1]], [[0, 0, 0], [0, 0, 0],
            [0, 0, 0], [0, 0, 0]]]}

img_3030 = {'name': 'IMG-3030', 'bboxes': [[3426, 724, 3628, 1776], [288, 854, 552, 1912]],
            'keypoints': [[[0, 0, 0], [3574, 802, 1], [0, 0, 0],
            [0, 0, 0]], [[428, 1868, 1], [338, 910, 1],
            [0, 0, 0], [0, 0, 0]]]}

img_3031 = {'name': 'IMG-3031', 'bboxes': [[3498, 1042, 3902, 2530], [26, 1250, 350, 2328]],
            'keypoints': [[[0, 0, 0], [0, 0, 0], [3750, 1216, 1],
            [0, 0, 0]], [[0, 0, 0], [34, 2308, 1],
            [190, 1286, 1], [0, 0, 0]]]}

img_3032 = {'name': 'IMG-3032', 'bboxes': [[1302, 1000, 2038, 1880], [2272, 1250, 2716, 1912]],
            'keypoints': [[[1574, 1868, 1], [1328, 1394, 1], [1726, 1018, 1],
            [2018, 1500, 1]], [[0, 0, 0], [0, 0, 0],
            [2493, 1352, 1], [2711, 1665, 1]]]}

img_3033 = {'name': 'IMG-3033', 'bboxes': [[890, 1178, 1236, 2008], [2906, 1568, 3186, 2542]],
            'keypoints': [[[1084, 1980, 1], [0, 0, 0], [0, 0, 0],
            [942, 1704, 1]], [[2940, 2462, 1], [0, 0, 0],
            [3158, 1672, 1], [3118, 2238, 1]]]}

img_3034 = {'name': 'IMG-3034', 'bboxes': [[1278, 936, 1798, 1578], [2098, 864, 2938, 1902]],
            'keypoints': [[[1556, 1560, 1], [0, 0, 0], [0, 0, 0],
            [1298, 1234, 1]], [[2486, 1896, 1], [2922, 1420, 1],
            [2606, 864, 1], [2106, 1356, 1]]]}

training_set = [img_2936, img_2937, img_2938, img_2939, img_2940, img_2941, img_2942, img_3025, img_3026,
                img_3027, img_3028, img_3029, img_3030, img_3031, img_3032, img_3033, img_3034, img_5806,
                img_5807, img_5808, img_5810, img_5811, img_5813, img_5814]

for img in training_set:
    filename = "train_dataset\\annotations\\" + img['name'] + ".json"
    with open(filename, 'w') as outfile:
        json.dump(img, outfile)
    outfile.close()

readfile = open('train_dataset\\annotations\\IMG-3034.json')
data = json.load(readfile)

for i in data['keypoints']:
    print(i)

readfile.close()

###### KEYPOINT AND BOUNDING BOX LABELS FOR TESTING ######
img_3035 = {'name': 'IMG-3035', 'bboxes': [[2212, 1036, 2670, 1356], [1590, 1416, 2322, 2168]],
            'keypoints': [[[0, 0, 0], [0, 0, 0], [2370, 1044, 1],
            [0, 0, 0]], [[1998, 2150, 1], [2306, 1816, 1], 
            [1872, 1452, 1],  [1604, 1814, 1]]]}

img_5803 = {'name': 'IMG_5803', 'bboxes': [[3326, 692, 3562, 1354], [1890, 1022, 2106, 1652]],
            'keypoints': [[[3500, 1480, 1], [3546, 1034, 1], [3388, 732, 1],
            [0, 0, 0]], [[2052, 1618, 1], [1950, 1370, 1],
            [1930, 1058, 1], [0, 0, 0]]]}

img_5809 = {'name': 'IMG_5809', 'bboxes': [[946, 1068, 1188, 1776], [2380, 1380, 2624, 2040]],
            'keypoints': [[[976, 1734, 1], [0, 0, 0], [1124, 1100, 1],
            [1036, 1454, 1]], [[2414, 2016, 1], [0, 0, 0], 
            [2556, 1458, 1],  [2414, 2014, 1]]]}

testing_dataset = [img_3035, img_5803, img_5809]

for img in testing_dataset:
    filename = "test_dataset\\annotations\\" + img['name'] + ".json"
    with open(filename, 'w') as outfile:
        json.dump(img, outfile)
    outfile.close()




